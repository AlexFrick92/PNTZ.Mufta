<UserControl x:Class="PNTZ.Mufta.TPCApp.View.Joint.JointProcessView"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                 xmlns:local="clr-namespace:PNTZ.Mufta.TPCApp.View.Joint"
                 xmlns:view="clr-namespace:PNTZ.Mufta.TPCApp.View"
                 xmlns:dxc="http://schemas.devexpress.com/winfx/2008/xaml/charts" 
                 xmlns:ctrl="clr-namespace:PNTZ.Mufta.TPCApp.View.Control"
                 xmlns:viewmodel="clr-namespace:PNTZ.Mufta.TPCApp.ViewModel" 
                 d:DataContext="{d:DesignInstance Type=viewmodel:JointProcessViewModel}"
             
                 mc:Ignorable="d" 
                 d:DesignHeight="850" d:DesignWidth="1200">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/View/Styles/AppStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <!--Заголовок параметров-->
            <Style x:Key="ParamHeaderLabel" TargetType="Label">
                <Setter Property="FontWeight" Value="SemiBold"/>
            </Style>
            <Style x:Key="HeaderUnderStroke" TargetType="Border">
                <Setter Property="BorderThickness" Value="0,1,0,0"/>
                <Setter Property="BorderBrush" Value="Black"/>
                <Setter Property="Margin" Value="0,0,0,5"/>
            </Style>


            <Style x:Key="ParamLabel" TargetType="Label">
                <Setter Property="Margin" Value="10,0,0,5"/>

            </Style>

            <Style x:Key="OutputLabel" TargetType="TextBox">
                <Setter Property="BorderThickness" Value="0,0,0,1"/>
                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                <Setter Property="Margin" Value="10,0,10,5"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="IsReadOnly" Value="True"/>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="210"/>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition />

        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <!--ПАРАМЕТРЫ-->
        <Grid Grid.Row="0" Grid.Column="0">
            <Border Grid.Column="0"
                BorderBrush="{StaticResource GridColor}"
                BorderThickness="0,0,0,1"
                    Background="{StaticResource LightColor}"
                >
                <Label                        
                        Content="ПАРАМЕТРЫ"
                        FontSize="18"                         
                        Margin="4"                                            
                        BorderThickness="0"                                        
                        />
            </Border>
        </Grid>

        <!--ТЕКУЩИЕ ПОКАЗАНИЯ-->
        <Grid Grid.Row="1" Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition Width="80"/>
            </Grid.ColumnDefinitions>


            <!--Текущие показания-->
            <StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Margin="5,10,5,5">
                <Label Style="{StaticResource ParamHeaderLabel}" Content="📈 Текущие показания"/>
                <Border Style="{StaticResource HeaderUnderStroke}"/>
            </StackPanel>

            <Label Grid.Row="1" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Момент"/>
            <TextBox Grid.Row="1" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding ActualPoint.Torque, StringFormat=N0, Mode=OneWay}"/>

            <Label Grid.Row="2" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Длина"/>
            <TextBox Grid.Row="2" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding ActualPoint.Length, StringFormat=F1, Mode=OneWay}"/>

            <Label Grid.Row="3" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Обороты"/>
            <TextBox Grid.Row="3" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding ActualPoint.Turns, StringFormat=F2, Mode=OneWay}"/>

            <Label Grid.Row="4" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Обороты/мин"/>
            <TextBox Grid.Row="4" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding ActualPoint.TurnsPerMinute, StringFormat=F2, Mode=OneWay}"/>

            <Label Grid.Row="5" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Отсчёт, сек"/>
            <TextBox Grid.Row="5" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding TimerSeconds, Mode=OneWay}"/>


            <!--Результат-->
            <StackPanel Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="2" Margin="5">
                <Label Style="{StaticResource ParamHeaderLabel}" Content="📋 Результат"/>
                <Border Style="{StaticResource HeaderUnderStroke}"/>
            </StackPanel>

            <Label Grid.Row="7" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Оценка"/>
            <TextBox Grid.Row="7" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LastJointResult.Result, Mode=OneWay}"/>

            <Label Grid.Row="8" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Итог. момент"/>
            <TextBox Grid.Row="8" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LastJointResult.FinalTorque, StringFormat=F1, Mode=OneWay}"/>

            <Label Grid.Row="9" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Итог. глубина"/>
            <TextBox Grid.Row="9" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LastJointResult.FinalLength, StringFormat=F1, Mode=OneWay}"/>

            <Label Grid.Row="10" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Итог. Обороты"/>
            <TextBox Grid.Row="10" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LastJointResult.FinalTurns, StringFormat=F2, Mode=OneWay}"/>

            <Label Grid.Row="11" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Глубина преднав."/>
            <TextBox Grid.Row="11" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LastJointResult.MVS_Len, StringFormat=F2, Mode=OneWay}"/>

            <Label Grid.Row="12" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Глубина силов."/>
            <TextBox Grid.Row="12" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LastJointResult.FinalMakeUpLength, StringFormat=F2, Mode=OneWay}"/>

            <!-- Данные рецепта -->
            <StackPanel Grid.Row="13" Grid.Column="0" Grid.ColumnSpan="2" Margin="5">
                <Label Style="{StaticResource ParamHeaderLabel}" Content="📐 Данные рецепта"/>
                <Border Style="{StaticResource HeaderUnderStroke}"/>
            </StackPanel>

            <Label Grid.Row="14" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Опт. момент"/>
            <TextBox Grid.Row="14" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LoadedRecipe.MU_Tq_Opt, StringFormat=F1, Mode=OneWay}"/>

            <Label Grid.Row="15" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Макс. момент"/>
            <TextBox Grid.Row="15" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LoadedRecipe.MU_Tq_Max, StringFormat=F1, Mode=OneWay}"/>

            <Label Grid.Row="16" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Мин. момент"/>
            <TextBox Grid.Row="16" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LoadedRecipe.MU_Tq_Min, StringFormat=F1, Mode=OneWay}"/>

            <Label Grid.Row="17" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Момент сброса"/>
            <TextBox Grid.Row="17" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LoadedRecipe.MU_Tq_Dump, StringFormat=F1, Mode=OneWay}"/>

            <Label Grid.Row="18" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Макс. глубина"/>
            <TextBox Grid.Row="18" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LoadedRecipe.MU_Len_Max, StringFormat=F1, Mode=OneWay}"/>

            <Label Grid.Row="19" Grid.Column="0"
                Style="{StaticResource ParamLabel}" Content="Мин. глубина"/>
            <TextBox Grid.Row="19" Grid.Column="1" Style="{StaticResource OutputLabel}" Text="{Binding LoadedRecipe.MU_Len_Min, StringFormat=F1, Mode=OneWay}"/>


        </Grid>

        <!--РАЗДЕЛИТЕЛЬ-->
        <Border Grid.Row="0" Grid.RowSpan="2" Grid.Column="1"
                BorderBrush="{StaticResource GridColor}"
                BorderThickness="1,0,0,0"
                Margin="0,0,0,-5"
        />

        <Grid Grid.Row="0" Grid.Column="2">
            <Border Grid.Column="1"
                BorderBrush="{StaticResource GridColor}"
                BorderThickness="0,0,0,1"
                    Background="{StaticResource LightColor}"
                >
                <Label                        
                        Content="ГРАФИКИ"
                        FontSize="18"         
                        Margin="4"
                        BorderThickness="0"                                        
                        />
            </Border>
        </Grid>
        <!--ГРАФИКИ И КНОПКИ РЕЗУЛЬТАТА-->
        <Grid Grid.Row="1" Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition Height="auto"/>
            </Grid.RowDefinitions>

            <!--ГРАФИКИ-->
            <ScrollViewer Grid.Row="0">

                <Grid >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="400"/>
                        <RowDefinition Height="400"/>
                    </Grid.RowDefinitions>

                    <!--Момент/обороты-->
                    <Border BorderThickness="0,0,1,1"
                            BorderBrush="{StaticResource GridColor}"
                            Grid.Row="0" Grid.Column="0">

                        <ctrl:RealtimeChartView
                                ChartTitle="Момент/обороты"
                                ChartData="{Binding ChartSeries}"
                                ArgumentMember="Turns"
                                ValueMember="Torque"
                                XMin="{Binding TorqueTurnsChartConfig.XMinValue}"
                                XMax="{Binding TorqueTurnsChartConfig.XMaxValue}"
                                YMin="{Binding TorqueTurnsChartConfig.YMinValue}"
                                YMax="{Binding TorqueTurnsChartConfig.YMaxValue}"
                                XGridSpacing="{Binding TorqueTurnsChartConfig.XGridSpacing}"
                                YGridSpacing="{Binding TorqueTurnsChartConfig.YGridSpacing}"
                                LineColor="Black"
                                LineThickness="2"
                                ResetZoomTrigger="{Binding ResetZoomTrigger}">
                            
                            <ctrl:RealtimeChartView.YConstantLines>
                                <ctrl:ConstantLineModel Value="{Binding DataContext.LoadedRecipe.MU_Tq_Max, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                            Label="Макс." Color="DarkRed"/>
                                <ctrl:ConstantLineModel Value="{Binding DataContext.LoadedRecipe.MU_Tq_Min, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                            Label="Мин." Color="DarkRed"/>
                                <ctrl:ConstantLineModel Value="{Binding DataContext.LoadedRecipe.MU_Tq_Opt, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                            Label="Опт." Color="DarkRed"/>
                            </ctrl:RealtimeChartView.YConstantLines>

                        </ctrl:RealtimeChartView>
                    </Border>

                    <!--(Обороты/Мин)/обороты-->
                    <Border BorderThickness="0,0,1,1"
                            BorderBrush="{StaticResource GridColor}"
                            Grid.Row="1" Grid.Column="0">

                        <ctrl:RealtimeChartView
                                ChartTitle="(Обороты/Мин)/обороты"
                                ChartData="{Binding ChartSeries}"
                                ArgumentMember="Turns"
                                ValueMember="TurnsPerMinute"
                                XMin="{Binding TurnsPerMinuteTurnsChartConfig.XMinValue}"
                                XMax="{Binding TurnsPerMinuteTurnsChartConfig.XMaxValue}"
                                YMin="{Binding TurnsPerMinuteTurnsChartConfig.YMinValue}"
                                YMax="{Binding TurnsPerMinuteTurnsChartConfig.YMaxValue}"
                                XGridSpacing="{Binding TurnsPerMinuteTurnsChartConfig.XGridSpacing}"
                                YGridSpacing="{Binding TurnsPerMinuteTurnsChartConfig.YGridSpacing}"
                                LineColor="Black"
                                LineThickness="2">
                        </ctrl:RealtimeChartView>
                    </Border>

                    <!--Момент/длина-->
                    <Border BorderThickness="0,0,1,1"
                            BorderBrush="{StaticResource GridColor}"
                            Grid.Row="0" Grid.Column="1">

                        <ctrl:RealtimeChartView
                                ChartTitle="Момент/длина"
                                ChartData="{Binding ChartSeries}"
                                ArgumentMember="Length"
                                ValueMember="Torque"
                                XMin="{Binding TorqueLengthChartConfig.XMinValue}"
                                XMax="{Binding TorqueLengthChartConfig.XMaxValue}"
                                YMin="{Binding TorqueLengthChartConfig.YMinValue}"
                                YMax="{Binding TorqueLengthChartConfig.YMaxValue}"
                                XGridSpacing="{Binding TorqueLengthChartConfig.XGridSpacing}"
                                YGridSpacing="{Binding TorqueLengthChartConfig.YGridSpacing}"
                                LineColor="Black"
                                LineThickness="2">
                            
                            <ctrl:RealtimeChartView.YConstantLines>
                                <ctrl:ConstantLineModel Value="{Binding DataContext.LoadedRecipe.MU_Tq_Max, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                            Label="Макс." Color="DarkRed"/>
                                <ctrl:ConstantLineModel Value="{Binding DataContext.LoadedRecipe.MU_Tq_Min, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            Label="Мин." Color="DarkRed"/>
                            </ctrl:RealtimeChartView.YConstantLines>

                            <ctrl:RealtimeChartView.XConstantLines>
                                <ctrl:ConstantLineModel Value="{Binding DataContext.LoadedRecipe.MU_Len_Max, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                        Label="Макс." Color="DarkRed"/>
                                <ctrl:ConstantLineModel Value="{Binding DataContext.LoadedRecipe.MU_Len_Min, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                        Label="Мин." Color="DarkRed"/>
                            </ctrl:RealtimeChartView.XConstantLines>

                        </ctrl:RealtimeChartView>
                    </Border>


                    <!--Момент/время-->

                    <Border BorderThickness="0,0,1,1"
                            BorderBrush="{StaticResource GridColor}"
                            Grid.Row="1" Grid.Column="1">

                        <ctrl:RealtimeChartView
                                ChartTitle="Момент/Время"
                                ChartData="{Binding ChartSeries}"
                                ArgumentMember="TimeStamp"
                                ValueMember="Torque"
                                XMin="{Binding TorqueTimeChartConfig.XMinValue}"
                                XMax="{Binding TorqueTimeChartConfig.XMaxValue}"
                                YMin="{Binding TorqueTimeChartConfig.YMinValue}"
                                YMax="{Binding TorqueTimeChartConfig.YMaxValue}"
                                XGridSpacing="{Binding TorqueTimeChartConfig.XGridSpacing}"
                                YGridSpacing="{Binding TorqueTimeChartConfig.YGridSpacing}"
                                LineColor="Black"
                                LineThickness="2">
                        </ctrl:RealtimeChartView>
                    </Border> 

                </Grid>
            </ScrollViewer>


            <!-- Оценка соединения -->

            <Border Grid.Row="1" BorderThickness="0,1,0,0" BorderBrush="#cecece">
                <Border.Style>
                    <!--Видимость при запросе результата-->
                    <Style TargetType="Border">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ShowResultButtons}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                <Grid >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="40"/>
                        <RowDefinition Height="10"/>
                    </Grid.RowDefinitions>

                    <Label Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                        HorizontalAlignment="Center">Требуется оценка результата</Label>

                    <Button Grid.Row ="1" Grid.Column="0"
                            HorizontalAlignment="Right"
                            Width="150"
                            Margin="5"
                            Background="Green"
                            Foreground="White"
                        Content="ГОДНОЕ"
                            Command="{Binding SetGoodResultCommand}"
                        />

                    <Button Grid.Row ="1" Grid.Column="1"
                            HorizontalAlignment="Left"
                            Width="150"
                            Margin="5"
                            Background="Red"
                            Foreground="White"
                            Content="БРАК"
                            Command="{Binding SetBadResultCommand}"
                        />


                </Grid>
            </Border>
        </Grid>

    </Grid>
</UserControl>
